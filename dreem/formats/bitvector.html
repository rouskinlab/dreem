<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mutation Vector &mdash; dreem 28.02.2023 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> dreem
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/main.html"><strong>Overview</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DREEM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IO.html">I/O files</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Download a test dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Logs.html">Logging</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plots</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../plots/get_started.html">Get started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plots/gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plots/create_a_plot.html">Write your own plots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../module/align/main.html">Alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module/vector/main.html">Vectorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module/aggregate/main.html">Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module/draw/main.html">Drawing (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module/cluster/main.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module/demultiplex/main.html">Demultiplexing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/dms.html">DMS-MaPseq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/dreem.html">DREEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">dreem</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Mutation Vector</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/dreem/formats/bitvector.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mutation-vector">
<h1>Mutation Vector<a class="headerlink" href="#mutation-vector" title="Permalink to this headline"></a></h1>
<p>Mutation vector files store the mutations in each read as a table in the Apache Optimized Row Columnar (ORC) format (extension <code class="docutils literal notranslate"><span class="pre">.orc</span></code>).
Each row of the table corresponds to one read and each column to one position in the reference sequence.
Accordingly, each row is labeled on its left side with the name of the read (from the QNAME field in the SAM file), and each column is labeled at the top with the base in the reference sequence (A, C, G, or T) followed by the position in the reference sequence (as in the example below).
The base at the 5’ end of the reference sequence is numbered 1, and the base at the 3’ end is numbered with the length of the sequence. DREEM allows generating mutation vectors over an entire reference sequence as well as over a section that may begin and end in the middle of the sequence.
The example below shows mutation vectors that begin at position 36 of the reference, and the base at that position is cytosine (C).</p>
<p><strong>Example</strong>:</p>
<p>An example showing the first three rows (reads) in a mutation vector file. Each element of the matrix is a hexadecimal representation of an integer from 0 (<code class="docutils literal notranslate"><span class="pre">00</span></code>) to 255 (<code class="docutils literal notranslate"><span class="pre">ff</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="n">C36</span> <span class="n">A37</span> <span class="n">C38</span> <span class="n">C39</span> <span class="n">A40</span> <span class="n">T41</span> <span class="n">C42</span> <span class="n">T43</span> <span class="n">G44</span>
   <span class="n">A</span>  <span class="mi">00</span>  <span class="mi">00</span>  <span class="mi">01</span>  <span class="mi">01</span>  <span class="mi">80</span>  <span class="mi">01</span>  <span class="mi">02</span>  <span class="mi">01</span>  <span class="mi">01</span>
   <span class="n">B</span>  <span class="mi">01</span>  <span class="mi">01</span>  <span class="mi">03</span>  <span class="mi">03</span>  <span class="mi">01</span>  <span class="mi">01</span>  <span class="mi">01</span>  <span class="mi">01</span>  <span class="mi">01</span>
   <span class="n">C</span>  <span class="mi">01</span>  <span class="mi">20</span>  <span class="mi">01</span>  <span class="mi">01</span>  <span class="n">e1</span>  <span class="mi">01</span>  <span class="mi">01</span>  <span class="mi">00</span>  <span class="mi">00</span>
</pre></div>
</div>
<p>Each element of the matrix contains 8 bits, each of which indicates a possible relationship between the read and the position in the reference sequence, according to the following table:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>Dec</p></th>
<th class="head"><p>Hex</p></th>
<th class="head"><p>Relationship</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>00000001</p></td>
<td><p>1</p></td>
<td><p>01</p></td>
<td><p>match</p></td>
</tr>
<tr class="row-odd"><td><p>00000010</p></td>
<td><p>2</p></td>
<td><p>02</p></td>
<td><p>deletion</p></td>
</tr>
<tr class="row-even"><td><p>00000100</p></td>
<td><p>4</p></td>
<td><p>04</p></td>
<td><p>insertion of ≥1 base(s) immediately 3’ of this position</p></td>
</tr>
<tr class="row-odd"><td><p>00001000</p></td>
<td><p>8</p></td>
<td><p>08</p></td>
<td><p>insertion of ≥1 base(s) immediately 5’ of this position</p></td>
</tr>
<tr class="row-even"><td><p>00010000</p></td>
<td><p>16</p></td>
<td><p>10</p></td>
<td><p>substitution to A</p></td>
</tr>
<tr class="row-odd"><td><p>00100000</p></td>
<td><p>32</p></td>
<td><p>20</p></td>
<td><p>substitution to C</p></td>
</tr>
<tr class="row-even"><td><p>01000000</p></td>
<td><p>64</p></td>
<td><p>40</p></td>
<td><p>substitution to G</p></td>
</tr>
<tr class="row-odd"><td><p>10000000</p></td>
<td><p>128</p></td>
<td><p>80</p></td>
<td><p>substitution to T</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<ul class="simple">
<li><p>Bit: which one of the 8 bits is set to 1</p></li>
<li><p>Dec: decimal (base 10) value of the binary number in the Bit column</p></li>
<li><p>Hex: hexadecimal (base 16) value of the binary number in the Bit column</p></li>
<li><p>Relationship: how the read compares with the position in the reference</p></li>
</ul>
<p>Usually, each element of the matrix has at most one bit set to 1 in the binary representation (e.g. <code class="docutils literal notranslate"><span class="pre">00010000</span></code>).
In the example matrix above, at read B, position 36, the element is <code class="docutils literal notranslate"><span class="pre">01</span></code> (hexadecimal) or <code class="docutils literal notranslate"><span class="pre">00000001</span></code> (binary), meaning that the base in the read is the same as the base in the reference (which is a C).
In read C at position 37, the element is <code class="docutils literal notranslate"><span class="pre">20</span></code> (hexadecimal) or <code class="docutils literal notranslate"><span class="pre">00100000</span></code> (binary), meaning that the read has a C at this position (while the reference sequence has an A).</p>
<p>Multiple bits may be set to 1 to indicate where the relationship between the read and the reference is ambiguous.
For example, in read B, positions 38 and 39 are both marked <code class="docutils literal notranslate"><span class="pre">03</span></code>, which is <code class="docutils literal notranslate"><span class="pre">00000011</span></code> in binary, with both the “match” and “deletion” bits turned on.
This value means that it is ambiguous whether the read contains a match or deletion at this position.
Read C at position 41 has a value of <code class="docutils literal notranslate"><span class="pre">e1</span></code>, which is <code class="docutils literal notranslate"><span class="pre">11100001</span></code> in binary, meaning that it could be a substitution to C, G, or T, or a match (i.e. A).
This situation happens if the base call has a low Phred score so its value cannot be trusted.</p>
<p>If all bits are zero (<code class="docutils literal notranslate"><span class="pre">00000000</span></code>), it means that the read did not align to that position in the reference sequence.
All-zero values occur only on the edges of a read, never in the middle, as can be seen at the first two positions of read A and the last two positions of read C.</p>
<p>See more about the vectorization algorithm <a class="reference internal" href="../../module/vector/main.html#vector-algos"><span class="std std-ref">here</span></a>.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Rouskin Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>